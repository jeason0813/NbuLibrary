define(["jquery","trafficcop"],function(n){var f={templates:{},storeTemplate:function(n,t){this.templates[n]=t},getTemplate:function(n){return this.templates[n]},purge:function(){this.templates={}}},e={templateIds:[],storeTemplate:function(n,t){var i=document.getElementById(n);i===null&&(this.templateIds.push(n),i=document.createElement("script"),i.type="text/html",i.id=n,document.body.appendChild(i)),i.text=t},getTemplate:function(n){return document.getElementById(n)},purge:function(){for(var n=0;n<this.templateIds.length;n++)document.body.removeChild(document.getElementById(this.templateIds[n]));this.templateIds=[]}},o="<div class='infuser-error'>The template <a href='{TEMPLATEURL}'>{TEMPLATEID}<\/a> could not be loaded. {STATUS}<\/div>",u=function(n,t,i){return o.replace("{STATUS}",n).replace("{TEMPLATEID}",t).replace("{TEMPLATEURL}",i)},i=[],r={getTemplatePath:function(n){var t=n.templatePrefix+n.templateId+n.templateSuffix;return n.templateUrl===undefined||n.templateUrl===""?t:n.templateUrl+"/"+t},templateGetSuccess:function(n,i){return function(r){t.store.storeTemplate(n,r),i(t.store.getTemplate(n))}},templateGetError:function(r,f,e){return function(o){n.inArray(r,i)===-1&&i.push(r);var s=u("HTTP Status code: "+o.status,r,f);t.store.storeTemplate(r,s),e(t.store.getTemplate(r))}},getAjaxOptions:function(){}},t={storageOptions:{hash:f,script:e},store:f,defaults:{templateUrl:"",templateSuffix:".html",templatePrefix:"",ajax:{async:!0,dataType:"html",type:"GET"},target:function(n){return"#"+n},loadingTemplate:{content:'<div class="infuser-loading">Loading...<\/div>',transitionIn:function(t,i){var r=n(t);r.hide(),r.html(i),r.fadeIn()},transitionOut:function(t){n(t).html("")}},postRender:function(){},preRender:function(){},render:function(t,i){var r=n(t);r.children().length===0?r.append(n(i)):r.children().replaceWith(n(i))},bindingInstruction:function(n){return n},useLoadingTemplate:!0},get:function(u,f){var e=n.extend({},t.defaults,typeof u=="object"?u:{templateId:u}),o;e.ajax.url=r.getTemplatePath(e),o=t.store.getTemplate(e.ajax.url),o&&n.inArray(e.ajax.url,i)===-1?f(o):(e.ajax.success=r.templateGetSuccess(e.ajax.url,f),e.ajax.error=r.templateGetError(e.templateId,e.ajax.url,f),n.trafficCop(e.ajax))},getSync:function(f){var e=n.extend({},t.defaults,typeof f=="object"?f:{templateId:f},{ajax:{async:!1}}),s,o;return e.ajax.url=r.getTemplatePath(e),s=t.store.getTemplate(e.ajax.url),s&&n.inArray(e.ajax.url,i)===-1||(o=null,e.ajax.success=function(n){o=n},e.ajax.error=function(){n.inArray(e.ajax.url)===-1&&i.push(e.ajax.url),o=u("HTTP Status code: exception.status",e.templateId,e.ajax.url)},n.ajax(e.ajax),o===null?o=u("An unknown error occurred.",e.templateId,e.ajax.url):(t.store.storeTemplate(e.ajax.url,o),s=t.store.getTemplate(e.ajax.url))),s},infuse:function(i,r){var u=n.extend({},t.defaults,typeof i=="object"?i:r,typeof i=="string"?{templateId:i}:undefined),f=typeof u.target=="function"?u.target(i):u.target;u.useLoadingTemplate&&u.loadingTemplate.transitionIn(f,u.loadingTemplate.content),t.get(u,function(n){var t=n;u.preRender(f,t),t=u.bindingInstruction(t,u.model),u.useLoadingTemplate&&u.loadingTemplate.transitionOut(f),u.render(f,t),u.postRender(f)})}};return t});
//@ sourceMappingURL=infuser-amd.min.js.map